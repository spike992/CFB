anti_cross_faction_trade_axis = {
	add_opinion_modifier = {
		target = GER
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = ITA
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = SPR
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = HUN
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = ROM
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = BUL
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = FIN
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = YUG
		modifier = anti_cross_faction_trade
	}

	add_opinion_modifier = {
		target = JAP
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = MAN
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = SIA
		modifier = anti_cross_faction_trade
	}
}

anti_cross_faction_trade_allies = {
	add_opinion_modifier = {
		target = USA
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = ENG
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = FRA
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = CAN
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = SAF
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = RAJ
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = AST
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = NZL
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = BRA
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = MEX
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = HOL
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = MAL
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = IRE
		modifier = anti_cross_faction_trade
	}

	add_opinion_modifier = {
		target = SOV
		modifier = anti_cross_faction_trade
	}
	add_opinion_modifier = {
		target = MON
		modifier = anti_cross_faction_trade
	}
}

anti_cross_faction_trade_all = {
	# allies
	USA = {
		anti_cross_faction_trade_axis = yes
	}
	ENG = {
		anti_cross_faction_trade_axis = yes
	}
	FRA = {
		anti_cross_faction_trade_axis = yes
	}
	USA = {
		anti_cross_faction_trade_axis = yes
	}
	CAN = {
		anti_cross_faction_trade_axis = yes
	}
	SAF = {
		anti_cross_faction_trade_axis = yes
	}
	RAJ = {
		anti_cross_faction_trade_axis = yes
	}
	AST = {
		anti_cross_faction_trade_axis = yes
	}
	NZL = {
		anti_cross_faction_trade_axis = yes
	}
	BRA = {
		anti_cross_faction_trade_axis = yes
	}
	MEX = {
		anti_cross_faction_trade_axis = yes
	}
	HOL = {
		anti_cross_faction_trade_axis = yes
	}
	MAL = {
		anti_cross_faction_trade_axis = yes
	}
	IRE = {
		anti_cross_faction_trade_axis = yes
	}

	SOV = {
		anti_cross_faction_trade_axis = yes
	}
	MON = {
		anti_cross_faction_trade_axis = yes
	}
	# axis
	GER = {
		anti_cross_faction_trade_allies = yes
	}
	ITA = {
		anti_cross_faction_trade_allies = yes
	}
	SPR = {
		anti_cross_faction_trade_allies = yes
	}
	HUN = {
		anti_cross_faction_trade_allies = yes
	}
	ROM = {
		anti_cross_faction_trade_allies = yes
	}
	BUL = {
		anti_cross_faction_trade_allies = yes
	}
	FIN = {
		anti_cross_faction_trade_allies = yes
	}
	YUG = {
		anti_cross_faction_trade_allies = yes
	}

	JAP = {
		anti_cross_faction_trade_allies = yes
	}
	MAN = {
		anti_cross_faction_trade_allies = yes
	}
	SIA = {
		anti_cross_faction_trade_allies = yes
	}
}

pow_before_annex = {
	hidden_effect = {
		set_variable = { getting_annexed = 1 }
		every_enemy_country = {
			limit = {
				is_playable_country = yes 
				OR = {
					NOT = {
						original_tag = FRA
					}
					has_global_flag = fall_of_france
				}
				OR = {
					NOT = {
						original_tag = HOL
					}
					has_global_flag = fall_of_france
				}
			}
			calculate_click_effect = yes
		}
	}
}

calculate_click_effect = { #prevent spam hidden idea for one day
	clear_variable = ROOT.pow_total
	every_enemy_country = {
		limit = {
			is_playable_country = yes
			OR = {
				NOT = {
					original_tag = FRA
				}
				has_global_flag = fall_of_france
			}
			OR = {
				NOT = {
					original_tag = HOL
				}
				has_global_flag = fall_of_france
			}
		}

		set_temp_variable = { casualty1 = 0 }

		while_loop_effect = {
			limit = {
				casualties_inflicted_by = {
					opponent = PREV
					thousands > casualty1
				}
			}
			add_to_temp_variable = { casualty1 = 1000 }
		}
		if = {
			limit = {
				casualties_inflicted_by = {
					opponent = PREV
					thousands < casualty1
				}
			}
			add_to_temp_variable  = { casualty1 = -1000 }
		}
		while_loop_effect = {
			limit = {
				casualties_inflicted_by = {
					opponent = PREV
					thousands > casualty1
				}
			}
			add_to_temp_variable = { casualty1 = 100 }
		}
		if = {
			limit = {
				casualties_inflicted_by = {
					opponent = PREV
					thousands < casualty1
				}
			}
			add_to_temp_variable  = { casualty1 = -100 }
		}
		while_loop_effect = {
			limit = {
				casualties_inflicted_by = {
					opponent = PREV
					thousands > casualty1
				}
			}
			add_to_temp_variable = { casualty1 = 10 }
		}
		if = {
			limit = {
				casualties_inflicted_by = {
					opponent = PREV
					thousands < casualty1
				}
			}
			add_to_temp_variable  = { casualty1 = -10 }
		}
		while_loop_effect = {
			limit = {
				casualties_inflicted_by = {
					opponent = PREV
					thousands > casualty1
				}
			}
			add_to_temp_variable = { casualty1 = 1 }
		}

		multiply_temp_variable = { casualty1 = 0.25 }
		if = {
			limit = {
				check_variable = { getting_annexed = 1 }
			}
			add_to_variable= { PREV.pow_other_sources = casualty1 }
		}
		else = {
			add_to_variable = { ROOT.pow_total = casualty1 }
		}
	}

	add_to_variable = { ROOT.pow_total = pow_other_sources  } 
	set_variable = { ROOT.pow_unassigned = ROOT.pow_total }
	subtract_from_variable = { ROOT.pow_unassigned = ROOT.pow_assinged_total }
}

Vichy_Spawn = {
	if = {
		limit = {
		AND = {
		461 = {has_state_flag = AFRICA_COMMONWEALTH_controls }
		461 = {is_controlled_by = VIC }
			}
		}
		461 = {
		clr_state_flag = AFRICA_COMMONWEALTH_controls
		set_state_flag = NOT_AFRICA_COMMONWEALTH_controls
		}
		every_country = {
				limit = {
					OR = {
						tag = FIN
						tag = GER
						tag = HUN
						tag = ITA
						tag = ROM
						tag = BUL
						tag = SPR
						tag = YUG
						tag = VIC
					}
				}
				AFRICA_COMMONWEALTH_AXIS_bases_level_down = yes
			}
		add_to_variable = {
				var = ITA.AFRICA_COMMONWEALTH_BASES_LEVEL
				value = 1
		}
	}
	
	if = {
		limit = {
			AND = {
				458 = {has_state_flag = AFRICA_COMMONWEALTH_controls }
				OR = {
					458 = {is_controlled_by = VIC }
					458 = {is_controlled_by = ITA }
				}
			}
		}
		458 = {
		clr_state_flag = AFRICA_COMMONWEALTH_controls
		set_state_flag = NOT_AFRICA_COMMONWEALTH_controls
		}
		every_country = {
				limit = {
					OR = {
						tag = FIN
						tag = GER
						tag = HUN
						tag = ITA
						tag = ROM
						tag = BUL
						tag = SPR
						tag = YUG
						tag = VIC
					}
				}
				AFRICA_COMMONWEALTH_AXIS_bases_level_down = yes
			}
		add_to_variable = {
				var = ITA.AFRICA_COMMONWEALTH_BASES_LEVEL
				value = 1
		}
	}

	AFRICA_COMMONWEALTH_AXIS_bases_level_down = {
		if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_16 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_16
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_17
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_15 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_15
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_16
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_14 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_14
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_15
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_13 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_13
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_14
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_12 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_12
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_13
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_11 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_11
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_12
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_10 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_10
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_11
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_9 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_9
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_10
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_8 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_8
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_9
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_7 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_7
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_8
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_6 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_6
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_7
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_5 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_5
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_6
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_4 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_4
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_5
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_3 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_3
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_4
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_2 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_2
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_3
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_1 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_1
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_2
			}
		}
	}
	AFRICA_COMMONWEALTH_AXIS_bases_level_up = {
		if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_2 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_2
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_1
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_3 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_3
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_2
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_4 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_4
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_3
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_5 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_5
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_4
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_6 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_6
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_5
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_7 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_7
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_6
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_8 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_8
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_7
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_9 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_9
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_8
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_10 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_10
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_9
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_11 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_11
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_10
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_12 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_12
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_11
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_13 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_13
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_12
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_14 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_14
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_13
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_15 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_15
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_14
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_16 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_16
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_15
			}
		}
		else_if = {
			limit = { has_idea = AFRICA_COMMONWEALTH_controls_axis_idea_17 }
			swap_ideas = {
				remove_idea = AFRICA_COMMONWEALTH_controls_axis_idea_17
				add_idea = AFRICA_COMMONWEALTH_controls_axis_idea_16
			}
		}
	}
	
}